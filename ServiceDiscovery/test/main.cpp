#include "../DNS.h"
#include <core/core.h>

using namespace WPEFramework::Plugin;
using namespace WPEFramework;
/**
 * Domain Name System (query)
 * Transaction ID: 0xba92
 * Flags: 0x0100 Standard query
 * Questions: 1
 * Answer RRs: 0
 * Authority RRs: 0
 * Additional RRs: 0
 **/
uint8_t DNSQ1[] = { "\xba\x92\x01\x00\x00\x01\x00\x00\x00\x00\x00\x01\x02\x68\x61\x06"
                    "\x62\x79\x62\x72\x61\x6d\x03\x63\x6f\x6d\x00\x00\x1c\x00\x01\x00"
                    "\x00\x29\x05\xc0\x00\x00\x00\x00" };
/**
 * Domain Name System (query)
 * Transaction ID: 0x6bf2
 * Flags: 0x0100 Standard query
 * Questions: 1
 * Answer RRs: 0
 * Authority RRs: 0
 * Additional RRs: 1
 **/
uint8_t DNSQ2[] = "\x6b\xf2\x01\x00\x00\x01\x00\x00\x00\x00\x00\x01\x12\x63\x6f\x6e"
                  "\x6e\x65\x63\x74\x69\x76\x69\x74\x79\x2d\x63\x68\x65\x63\x6b\x06"
                  "\x75\x62\x75\x6e\x74\x75\x03\x63\x6f\x6d\x00\x00\x01\x00\x01\x00"
                  "\x00\x29\x05\xc0\x00\x00\x00\x00\x00";
/**
 * Domain Name System (response)
 * Transaction ID: 0x6bf2
 * Flags: 0x8180 Standard query response, No error
 * Questions: 1
 * Answer RRs: 9
 * Authority RRs: 0
 * Additional RRs: 1
 **/
uint8_t DNSR1[] = "\x6b\xf2\x81\x80\x00\x01\x00\x09\x00\x00\x00\x01\x12\x63\x6f\x6e"
                  "\x6e\x65\x63\x74\x69\x76\x69\x74\x79\x2d\x63\x68\x65\x63\x6b\x06"
                  "\x75\x62\x75\x6e\x74\x75\x03\x63\x6f\x6d\x00\x00\x01\x00\x01\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\x23\xe8\x6f\x11\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\xb9\x7d\xbe\x31\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\x5b\xbd\x5b\x31\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\xb9\x7d\xbe\x12\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\x23\xe0\xaa\x54\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\xb9\x7d\xbe\x11\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\x5b\xbd\x5b\x30\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\xb9\x7d\xbe\x30\xc0"
                  "\x0c\x00\x01\x00\x01\x00\x00\x00\x37\x00\x04\x22\x7a\x79\x20\x00"
                  "\x00\x29\x04\xd0\x00\x00\x00\x00\x00";

/**
 * Domain Name System (response)
 * Transaction ID: 0xee52
 * Flags: 0x8180 Standard query response, No error
 * Questions: 1
 * Answer RRs: 0
 * Authority RRs: 1
 * Additional RRs: 1
 **/
uint8_t DNSR2[] = "\xee\x52\x81\x80\x00\x01\x00\x00\x00\x01\x00\x01\x08\x69\x70\x76"
                  "\x34\x6f\x6e\x6c\x79\x04\x61\x72\x70\x61\x00\x00\x1c\x00\x01\xc0"
                  "\x0c\x00\x06\x00\x01\x00\x00\x07\xdb\x00\x2d\x03\x73\x6e\x73\x03"
                  "\x64\x6e\x73\x05\x69\x63\x61\x6e\x6e\x03\x6f\x72\x67\x00\x03\x6e"
                  "\x6f\x63\xc0\x2f\x78\x86\x5f\x24\x00\x00\x1c\x20\x00\x00\x0e\x10"
                  "\x00\x09\x3a\x80\x00\x00\x0e\x10\x00\x00\x29\x04\xd0\x00\x00\x00"
                  "\x00\x00\x00}";

int main(int argc, char* argv[])
{
    DNS::Frame frame(DNSR2, sizeof(DNSR2));

    std::string loadedData;
    Core::ToHexString(frame.Data(), frame.Size(), loadedData);
    printf("Data[%d]: %s\n", frame.Size(), loadedData.c_str());

    ASSERT(sizeof(DNSR2) == frame.Size());

    uint16_t id = frame.TransactionId();
    bool q = frame.IsQuery();
    bool tc = frame.IsTruncated();
    bool aa = frame.IsAuthoritativeAnswer();
    DNS::OperationCode oc = frame.Operation();
    DNS::ResponseCode rc = frame.Response();

    Core::Singleton::Dispose();

    return EXIT_SUCCESS;
}